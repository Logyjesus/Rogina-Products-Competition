<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
     
    <!-- Primary Meta Tags -->
    <title>Ù…Ø³Ø§Ø¨Ù‚Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª - Ù†Ø¸Ø§Ù… Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ù„Ù„ØªØµÙˆÙŠØª ÙˆØ§Ù„Ù…Ø³Ø§Ø¨Ù‚Ø§Øª</title>
    <meta name="title" content="Ù…Ø³Ø§Ø¨Ù‚Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª - Ù†Ø¸Ø§Ù… Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ù„Ù„ØªØµÙˆÙŠØª ÙˆØ§Ù„Ù…Ø³Ø§Ø¨Ù‚Ø§Øª">
    <meta name="description" content="Ù†Ø¸Ø§Ù… Ø´Ø§Ù…Ù„ Ù„Ø¥Ø¯Ø§Ø±Ø© Ù…Ø³Ø§Ø¨Ù‚Ø§Øª Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ù…Ø¹ Ù†Ø¸Ø§Ù… ØªØµÙˆÙŠØª Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ø¹Ø§Ø¯Ù„. ÙŠØ¯Ø¹Ù… Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠÙ† ÙˆØ§Ù„Ø¨Ø§Ø¦Ø¹ÙŠÙ† ÙˆØ§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†. Ù…Ø´Ø±ÙˆØ¹ ØªØ®Ø±Ø¬ Ù…Ù† Ø¬Ø§Ù…Ø¹Ø© Ù‚Ù†Ø§ - ÙƒÙ„ÙŠØ© Ø§Ù„ØªØ±Ø¨ÙŠØ© Ø§Ù„Ù†ÙˆØ¹ÙŠØ©">
    <meta name="keywords" content="Ù…Ø³Ø§Ø¨Ù‚Ø© Ù…Ù†ØªØ¬Ø§Øª, ØªØµÙˆÙŠØª Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ, Ø¬Ø§Ù…Ø¹Ø© Ù‚Ù†Ø§, ÙƒÙ„ÙŠØ© ØªØ±Ø¨ÙŠØ© Ù†ÙˆØ¹ÙŠØ©, ØªÙƒÙ†ÙˆÙ„ÙˆØ¬ÙŠØ§ Ø§Ù„ØªØ¹Ù„ÙŠÙ…, Ù…Ø´Ø±ÙˆØ¹ ØªØ®Ø±Ø¬, Ù†Ø¸Ø§Ù… Ù…Ø³Ø§Ø¨Ù‚Ø§Øª, Ø±ÙˆØ¬ÙŠÙ†Ø§ Ø±ÙˆÙ…Ø§Ù†ÙŠ">
    <meta name="author" content="Ø±ÙˆØ¬ÙŠÙ†Ø§ Ø±ÙˆÙ…Ø§Ù†ÙŠ Ù…Ø­Ø§Ø±Ø¨ Ø¨ÙˆÙ„Ø³">
    <meta name="robots" content="index, follow">
    <meta name="language" content="Arabic">
    <meta name="revisit-after" content="7 days">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://logyjesus.github.io/Attend-by-Rogina-App/">
    <meta property="og:title" content="Ù…Ø³Ø§Ø¨Ù‚Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª - Ù†Ø¸Ø§Ù… Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ù„Ù„ØªØµÙˆÙŠØª ÙˆØ§Ù„Ù…Ø³Ø§Ø¨Ù‚Ø§Øª">
    <meta property="og:description" content="Ù†Ø¸Ø§Ù… Ø´Ø§Ù…Ù„ Ù„Ø¥Ø¯Ø§Ø±Ø© Ù…Ø³Ø§Ø¨Ù‚Ø§Øª Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ù…Ø¹ Ù†Ø¸Ø§Ù… ØªØµÙˆÙŠØª Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ø¹Ø§Ø¯Ù„. Ù…Ø´Ø±ÙˆØ¹ ØªØ®Ø±Ø¬ Ù…Ù† Ø¬Ø§Ù…Ø¹Ø© Ù‚Ù†Ø§">
    <meta property="og:image" content="https://ibb.co/nqZzXmGX">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:locale" content="ar_AR">
    <meta property="og:site_name" content="Ù…Ø³Ø§Ø¨Ù‚Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://logyjesus.github.io/Attend-by-Rogina-App/">
    <meta property="twitter:title" content="Ù…Ø³Ø§Ø¨Ù‚Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª - Ù†Ø¸Ø§Ù… Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ù„Ù„ØªØµÙˆÙŠØª ÙˆØ§Ù„Ù…Ø³Ø§Ø¨Ù‚Ø§Øª">
    <meta property="twitter:description" content="Ù†Ø¸Ø§Ù… Ø´Ø§Ù…Ù„ Ù„Ø¥Ø¯Ø§Ø±Ø© Ù…Ø³Ø§Ø¨Ù‚Ø§Øª Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ù…Ø¹ Ù†Ø¸Ø§Ù… ØªØµÙˆÙŠØª Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ø¹Ø§Ø¯Ù„. Ù…Ø´Ø±ÙˆØ¹ ØªØ®Ø±Ø¬ Ù…Ù† Ø¬Ø§Ù…Ø¹Ø© Ù‚Ù†Ø§">
    <meta property="twitter:image" content="https://ibb.co/nqZzXmGX">
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" sizes="32x32" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ†</text></svg>">
    <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ†</text></svg>">
    
    <!-- Theme Color -->
    <meta name="theme-color" content="#667eea">
    <meta name="msapplication-TileColor" content="#667eea">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://logyjesus.github.io/Attend-by-Rogina-App/">

    <title>Ù…Ø³Ø§Ø¨Ù‚Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.39.3/dist/umd/supabase.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 10px;
        }

        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            max-width: 1200px;
            width: 100%;
            padding: 20px;
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        h1 {
            color: #667eea;
            text-align: center;
            margin-bottom: 20px;
            font-size: clamp(1.5rem, 5vw, 2.5rem);
        }

        h2 {
            color: #764ba2;
            margin: 20px 0 15px;
            padding-bottom: 10px;
            border-bottom: 3px solid #667eea;
            font-size: clamp(1.2rem, 4vw, 1.8rem);
        }

        .auth-container {
            max-width: 400px;
            margin: 0 auto;
        }

        .form-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            color: #333;
            font-weight: bold;
            font-size: clamp(0.9rem, 2vw, 1rem);
        }

        input, select, textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: clamp(0.9rem, 2vw, 1rem);
            transition: border-color 0.3s;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        textarea {
            resize: vertical;
            min-height: 100px;
        }

        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            font-size: clamp(0.9rem, 2vw, 1rem);
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            margin: 5px;
            width: auto;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        button:active {
            transform: translateY(0);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }

        .btn-danger {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%);
        }

        .btn-success {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
        }

        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        @media (max-width: 768px) {
            .products-grid {
                grid-template-columns: 1fr;
            }
        }

        .product-card {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s;
        }

        .product-card:hover {
            transform: translateY(-5px);
        }

        .product-card img {
            width: 100%;
            height: 200px;
            object-fit: cover;
            border-radius: 10px;
            margin-bottom: 15px;
        }

        .product-card h3 {
            color: #667eea;
            margin-bottom: 10px;
            font-size: clamp(1rem, 3vw, 1.3rem);
        }

        .product-card p {
            color: #666;
            margin-bottom: 10px;
            font-size: clamp(0.85rem, 2vw, 1rem);
            word-wrap: break-word;
        }

        .votes-count {
            background: #667eea;
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            display: inline-block;
            margin: 10px 0;
            font-weight: bold;
            font-size: clamp(0.85rem, 2vw, 1rem);
        }

        .user-info {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
        }

        @media (max-width: 480px) {
            .user-info {
                flex-direction: column;
                text-align: center;
            }
        }

        .table-container {
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            min-width: 500px;
        }

        th, td {
            padding: 12px;
            text-align: right;
            border-bottom: 1px solid #ddd;
            font-size: clamp(0.85rem, 2vw, 1rem);
        }

        th {
            background: #667eea;
            color: white;
            font-weight: bold;
        }

        tr:hover {
            background: #f8f9fa;
        }

        .winner-card {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            margin: 20px 0;
        }

        .winner-card h3 {
            font-size: clamp(1.5rem, 4vw, 2rem);
            margin-bottom: 10px;
        }

        .winner-card img {
            max-width: 100%;
            height: auto;
            max-height: 300px;
            object-fit: contain;
            border-radius: 10px;
            margin: 15px 0;
        }

        .hidden {
            display: none;
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .tabs button {
            flex: 1;
            min-width: 120px;
        }

        @media (max-width: 480px) {
            .tabs button {
                flex: 1 1 100%;
            }
        }

        .file-input-wrapper {
            position: relative;
            overflow: hidden;
            display: inline-block;
            width: 100%;
        }

        .file-input-wrapper input[type=file] {
            position: absolute;
            left: -9999px;
        }

        .file-input-label {
            background: #f8f9fa;
            border: 2px dashed #667eea;
            color: #667eea;
            padding: 20px;
            border-radius: 8px;
            cursor: pointer;
            display: block;
            text-align: center;
            transition: all 0.3s;
            font-size: clamp(0.9rem, 2vw, 1rem);
        }

        .file-input-label:hover {
            background: #e8e9ff;
        }

        .loading {
            text-align: center;
            color: #667eea;
            margin: 20px 0;
        }

        .btn-edit {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }

        .btn-delete {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%);
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            animation: fadeIn 0.3s ease-in;
            overflow-y: auto;
        }

        .modal-content {
            background-color: white;
            margin: 20px auto;
            padding: 20px;
            border-radius: 15px;
            max-width: 500px;
            width: calc(100% - 40px);
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
            animation: slideDown 0.3s ease-out;
        }

        @keyframes slideDown {
            from { transform: translateY(-50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .close {
            color: #aaa;
            float: left;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }

        .close:hover {
            color: #000;
        }

        .reset-info {
            background: #fff3cd;
            border: 2px solid #ffc107;
            color: #856404;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            text-align: center;
            font-size: clamp(0.9rem, 2vw, 1rem);
        }

        .countdown {
            font-size: clamp(1.2rem, 3vw, 1.5rem);
            font-weight: bold;
            color: #764ba2;
            margin: 10px 0;
        }

        .button-group {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            margin-top: 10px;
        }

        .button-group button {
            flex: 1;
            min-width: 100px;
        }

        .info-icon {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            cursor: pointer;
            box-shadow: 0 5px 25px rgba(102, 126, 234, 0.5);
            transition: all 0.3s;
            z-index: 999;
            border: 3px solid white;
        }

        .info-icon:hover {
            transform: scale(1.1) rotate(10deg);
            box-shadow: 0 8px 35px rgba(102, 126, 234, 0.7);
        }

        .info-page {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 9999;
            overflow-y: auto;
            animation: fadeIn 0.3s ease-in;
        }

        .info-content {
            background: white;
            max-width: 900px;
            margin: 30px auto;
            border-radius: 25px;
            overflow: hidden;
            box-shadow: 0 20px 80px rgba(0, 0, 0, 0.5);
            animation: slideDown 0.4s ease-out;
        }

        .info-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px 30px;
            text-align: center;
            position: relative;
        }

        .info-header h1 {
            color: white;
            margin: 0 0 10px 0;
            font-size: clamp(1.8rem, 5vw, 2.8rem);
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .info-header p {
            margin: 5px 0;
            font-size: clamp(1rem, 3vw, 1.3rem);
            opacity: 0.95;
        }

        .close-info {
            position: absolute;
            top: 15px;
            left: 15px;
            color: white;
            font-size: 35px;
            cursor: pointer;
            width: 45px;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            transition: all 0.3s;
        }

        .close-info:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: rotate(90deg);
        }

        .logos-container {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 30px;
            margin: 30px 0 20px;
            flex-wrap: wrap;
        }

        .logo-box {
            background: white;
            padding: 15px;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
            width: 120px;
            height: 142px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: transform 0.3s;
        }

        .logo-box:hover {
            transform: translateY(-5px);
        }

        .logo-box img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }

        .info-body {
            padding: 40px 30px;
        }

        .info-section {
            margin-bottom: 30px;
            padding: 25px;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 15px;
            border-right: 5px solid #667eea;
            transition: transform 0.3s;
        }

        .info-section:hover {
            transform: translateX(-5px);
        }

        .info-section h3 {
            color: #667eea;
            margin: 0 0 15px 0;
            font-size: clamp(1.3rem, 4vw, 1.8rem);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .info-section p {
            margin: 8px 0;
            color: #333;
            font-size: clamp(1rem, 3vw, 1.2rem);
            line-height: 1.8;
        }

        .info-section strong {
            color: #764ba2;
            font-weight: bold;
        }

        .developer-card {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 30px;
            border-radius: 20px;
            text-align: center;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(240, 147, 251, 0.4);
        }

        .developer-card h2 {
            color: white;
            margin: 0 0 15px 0;
            font-size: clamp(1.5rem, 4vw, 2.2rem);
        }

        .developer-card p {
            margin: 10px 0;
            font-size: clamp(1.1rem, 3vw, 1.4rem);
        }

        .supervisor-card {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(17, 153, 142, 0.4);
        }

        .supervisor-card h3 {
            color: white;
            margin: 0 0 10px 0;
            font-size: clamp(1.3rem, 4vw, 1.8rem);
        }

        .supervisor-card p {
            margin: 0;
            font-size: clamp(1.1rem, 3vw, 1.3rem);
        }

        .project-info {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            margin-top: 20px;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
            margin-bottom: 30px;
        }

        .project-info h3 {
            color: white;
            margin: 0 0 10px 0;
            font-size: clamp(1.3rem, 4vw, 1.8rem);
        }

        .project-info p {
            margin: 5px 0;
            font-size: clamp(1rem, 3vw, 1.2rem);
        }

        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }

            .product-card button,
            button {
                width: 100%;
                margin: 5px 0;
            }

            .button-group button {
                flex: 1 1 100%;
            }

            .info-icon {
                width: 50px;
                height: 50px;
                font-size: 24px;
                bottom: 15px;
                left: 15px;
            }

            .logos-container {
                gap: 15px;
            }

            .logo-box {
                width: 80px;
                height: 80px;
            }

            .info-body {
                padding: 25px 20px;
            }

            .info-section {
                padding: 20px 15px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ† Ù…Ø³Ø§Ø¨Ù‚Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</h1>

        <!-- Auth Screen -->
        <div id="authScreen">
            <div class="auth-container">
                <h2>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ / Ø§Ù„ØªØ³Ø¬ÙŠÙ„</h2>
                <div class="form-group">
                    <label>Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
                    <input type="email" id="authEmail" placeholder="example@email.com">
                </div>
                <div class="form-group">
                    <label>ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
                    <input type="password" id="authPassword" placeholder="********">
                </div>
                <div class="form-group">
                    <label>Ø§Ù„Ø¯ÙˆØ± (Ù„Ù„ØªØ³Ø¬ÙŠÙ„ ÙÙ‚Ø·)</label>
                    <select id="authRole">
                        <option value="user">Ù…Ø³ØªØ®Ø¯Ù… Ø¹Ø§Ø¯ÙŠ</option>
                        <option value="seller">Ø¨Ø§Ø¦Ø¹</option>
                        <option value="admin">Ù…Ø³Ø¤ÙˆÙ„</option>
                    </select>
                </div>
                <button onclick="login()">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</button>
                <button onclick="register()" class="btn-secondary">ØªØ³Ø¬ÙŠÙ„ Ø¬Ø¯ÙŠØ¯</button>
            </div>
        </div>

        <!-- Admin Dashboard -->
        <div id="adminScreen" class="hidden">
            <div class="user-info">
                <span>ğŸ‘¤ Ù…Ø±Ø­Ø¨Ø§Ù‹ØŒ <strong id="adminEmail"></strong> (Ù…Ø³Ø¤ÙˆÙ„)</span>
                <button onclick="logout()" class="btn-danger">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</button>
            </div>
            
            <div class="tabs">
                <button onclick="showAdminTab('users')">Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</button>
                <button onclick="showAdminTab('products')">Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</button>
                <button onclick="showAdminTab('votes')">Ø§Ù„Ø£ØµÙˆØ§Øª</button>
                <button onclick="showAdminTab('winner')">Ø§Ù„ÙØ§Ø¦Ø²</button>
            </div>

            <div id="adminUsers" class="hidden">
                <h2>Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªØ®Ø¯Ù… Ø¬Ø¯ÙŠØ¯</h2>
                <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin-bottom: 20px;">
                    <div class="form-group">
                        <label>Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
                        <input type="email" id="newUserEmail" placeholder="example@email.com">
                    </div>
                    <div class="form-group">
                        <label>ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
                        <input type="password" id="newUserPassword" placeholder="********">
                    </div>
                    <div class="form-group">
                        <label>Ø§Ù„Ø¯ÙˆØ±</label>
                        <select id="newUserRole">
                            <option value="user">Ù…Ø³ØªØ®Ø¯Ù… Ø¹Ø§Ø¯ÙŠ</option>
                            <option value="seller">Ø¨Ø§Ø¦Ø¹</option>
                            <option value="admin">Ù…Ø³Ø¤ÙˆÙ„</option>
                        </select>
                    </div>
                    <button onclick="addNewUser()">â• Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</button>
                </div>

                <h2>Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</h2>
                <div class="form-group">
                    <input type="text" id="searchUsers" placeholder="ğŸ” Ø§Ø¨Ø­Ø« Ø¹Ù† Ù…Ø³ØªØ®Ø¯Ù…..." onkeyup="searchUsers()">
                </div>
                <div class="table-container">
                    <table id="usersTable">
                        <thead>
                            <tr>
                                <th>Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</th>
                                <th>Ø§Ù„Ø¯ÙˆØ±</th>
                                <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>

            <div id="adminProducts" class="hidden">
                <h2>Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</h2>
                <div class="form-group">
                    <input type="text" id="searchAdminProducts" placeholder="ğŸ” Ø§Ø¨Ø­Ø« Ø¹Ù† Ù…Ù†ØªØ¬..." onkeyup="searchAdminProducts()">
                </div>
                <div class="form-group">
                    <label>ÙÙ„ØªØ±Ø© Ø­Ø³Ø¨ Ø§Ù„Ø¨Ø§Ø¦Ø¹</label>
                    <select id="filterAdminSeller" onchange="filterAdminProducts()">
                        <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨Ø§Ø¦Ø¹ÙŠÙ†</option>
                    </select>
                </div>
                <div class="products-grid" id="adminProductsGrid"></div>
            </div>

            <div id="adminVotes" class="hidden">
                <h2>Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£ØµÙˆØ§Øª</h2>
                <div class="table-container">
                    <table id="votesTable">
                        <thead>
                            <tr>
                                <th>Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</th>
                                <th>Ø§Ù„Ù…Ù†ØªØ¬</th>
                                <th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>

            <div id="adminWinner" class="hidden"></div>
        </div>

        <!-- Seller Dashboard -->
        <div id="sellerScreen" class="hidden">
            <div class="user-info">
                <span>ğŸ›’ Ù…Ø±Ø­Ø¨Ø§Ù‹ØŒ <strong id="sellerEmail"></strong> (Ø¨Ø§Ø¦Ø¹)</span>
                <button onclick="logout()" class="btn-danger">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</button>
            </div>

            <div class="tabs">
                <button onclick="showSellerTab('myproducts')">Ù…Ù†ØªØ¬Ø§ØªÙŠ</button>
                <button onclick="showSellerTab('winner')">Ø§Ù„ÙØ§Ø¦Ø²</button>
            </div>

            <div id="sellerMyProducts">
                <h2>Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬ Ø¬Ø¯ÙŠØ¯</h2>
                <div class="form-group">
                    <label>Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬</label>
                    <input type="text" id="productName" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬">
                </div>
                <div class="form-group">
                    <label>ÙˆØµÙ Ø§Ù„Ù…Ù†ØªØ¬</label>
                    <textarea id="productDescription" placeholder="Ø£Ø¯Ø®Ù„ ÙˆØµÙ Ø§Ù„Ù…Ù†ØªØ¬"></textarea>
                </div>
                <div class="form-group">
                    <label>ØµÙˆØ±Ø© Ø§Ù„Ù…Ù†ØªØ¬</label>
                    <div class="file-input-wrapper">
                        <label for="productImage" class="file-input-label">
                            ğŸ“ Ø§Ø®ØªØ± ØµÙˆØ±Ø© Ø§Ù„Ù…Ù†ØªØ¬
                        </label>
                        <input type="file" id="productImage" accept="image/*">
                    </div>
                </div>
                <button onclick="uploadProduct()">Ø±ÙØ¹ Ø§Ù„Ù…Ù†ØªØ¬</button>

                <h2>Ù…Ù†ØªØ¬Ø§ØªÙŠ</h2>
                <div class="form-group">
                    <input type="text" id="searchSellerProducts" placeholder="ğŸ” Ø§Ø¨Ø­Ø« ÙÙŠ Ù…Ù†ØªØ¬Ø§ØªÙƒ..." onkeyup="searchSellerProducts()">
                </div>
                <div class="products-grid" id="sellerProductsGrid"></div>
            </div>

            <div id="sellerWinner" class="hidden"></div>
        </div>

        <!-- User Dashboard -->
        <div id="userScreen" class="hidden">
            <div class="user-info">
                <span>ğŸ‘¤ Ù…Ø±Ø­Ø¨Ø§Ù‹ØŒ <strong id="userEmail"></strong> (Ù…Ø³ØªØ®Ø¯Ù…)</span>
                <button onclick="logout()" class="btn-danger">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</button>
            </div>

            <div class="tabs">
                <button onclick="showUserTab('products')">Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</button>
                <button onclick="showUserTab('winner')">Ø§Ù„ÙØ§Ø¦Ø²</button>
            </div>

            <div id="userProducts">
                <h2>Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</h2>
                <div class="form-group">
                    <input type="text" id="searchUserProducts" placeholder="ğŸ” Ø§Ø¨Ø­Ø« Ø¹Ù† Ù…Ù†ØªØ¬..." onkeyup="searchUserProducts()">
                </div>
                <div class="form-group">
                    <label>ÙÙ„ØªØ±Ø© Ø­Ø³Ø¨</label>
                    <select id="filterUserProducts" onchange="filterUserProducts()">
                        <option value="all">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</option>
                        <option value="most_voted">Ø§Ù„Ø£ÙƒØ«Ø± ØªØµÙˆÙŠØªØ§Ù‹</option>
                        <option value="least_voted">Ø§Ù„Ø£Ù‚Ù„ ØªØµÙˆÙŠØªØ§Ù‹</option>
                    </select>
                </div>
                <div class="products-grid" id="userProductsGrid"></div>
            </div>

            <div id="userWinner" class="hidden"></div>
        </div>

        <!-- Edit Product Modal -->
        <div id="editModal" class="modal">
            <div class="modal-content">
                <span class="close" onclick="closeEditModal()">&times;</span>
                <h2>ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬</h2>
                <div class="form-group">
                    <label>Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬</label>
                    <input type="text" id="editProductName">
                </div>
                <div class="form-group">
                    <label>ÙˆØµÙ Ø§Ù„Ù…Ù†ØªØ¬</label>
                    <textarea id="editProductDescription"></textarea>
                </div>
                <div class="form-group">
                    <label>ØµÙˆØ±Ø© Ø¬Ø¯ÙŠØ¯Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
                    <div class="file-input-wrapper">
                        <label for="editProductImage" class="file-input-label">
                            ğŸ“ Ø§Ø®ØªØ± ØµÙˆØ±Ø© Ø¬Ø¯ÙŠØ¯Ø©
                        </label>
                        <input type="file" id="editProductImage" accept="image/*">
                    </div>
                </div>
                <button onclick="saveProductEdit()">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª</button>
                <button onclick="closeEditModal()" class="btn-secondary">Ø¥Ù„ØºØ§Ø¡</button>
            </div>
        </div>

        <!-- Info Icon -->
        <div id="infoIcon" class="info-icon hidden" onclick="openInfoPage()">
            â„¹ï¸
        </div>

        <!-- Info Page -->
        <div id="infoPage" class="info-page">
            <div class="info-content">
                <div class="info-header">
                    <span class="close-info" onclick="closeInfoPage()">&times;</span>
                    <h1>ğŸ† Ù…Ø³Ø§Ø¨Ù‚Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</h1>
                    <p>Ù†Ø¸Ø§Ù… Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ù…ØªÙƒØ§Ù…Ù„ Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³Ø§Ø¨Ù‚Ø§Øª ÙˆØ§Ù„ØªØµÙˆÙŠØª</p>
                    
                    <div class="logos-container">
                        <div class="logo-box">
                            <div style="font-size: 60px;"><img src="https://tse2.mm.bing.net/th/id/OIP.FgvAq778CDgRZnR6ikkB6AAAAA?cb=ucfimg2&ucfimg=1&rs=1&pid=ImgDetMain&o=7&rm=3" alt="ğŸ“Ø¬Ø§Ù…Ø© Ù‚Ù†Ø§"></div>
                        </div>
                        <div class="logo-box">
                            <div style="font-size: 60px;"><img src="https://tse1.mm.bing.net/th/id/OIP.kppON8tQ3AAZ7Ewp3GGaVwHaHW?cb=ucfimg2&ucfimg=1&rs=1&pid=ImgDetMain&o=7&rm=3" alt="ğŸ›ï¸ÙƒÙ„ÙŠØ© ØªØ±Ø¨ÙŠØ© Ù†ÙˆØ¹ÙŠØ©"></div>
                        </div>
                        <div class="logo-box">
                            <div style="font-size: 60px;"><img src="https://www.svu.edu.eg/faculties/sed/wp-content/uploads/2022/07/Asset-10.png" alt="ğŸ’» Ù‚Ø³Ù… ØªÙƒÙ†ÙˆÙ„ÙˆØ¬ÙŠØ§ Ø§Ù„ØªØ¹Ù„ÙŠÙ… ÙˆØ§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª"></div>
                        </div>
                    </div>
                </div>

                <div class="info-body">
                    <div class="developer-card">
                        <h2>ğŸ‘¨â€ğŸ’» Ø§Ù„Ù…Ø·ÙˆØ±</h2>
                        <p style="font-size: clamp(1.3rem, 4vw, 1.8rem); font-weight: bold; margin: 15px 0;">
                            Ø±ÙˆØ¬ÙŠÙ†Ø§ Ø±ÙˆÙ…Ø§Ù†ÙŠ Ù…Ø­Ø§Ø±Ø¨ Ø¨ÙˆÙ„Ø³
                        </p>
                        <p>ğŸ“ Ø§Ù„ÙØ±Ù‚Ø© Ø§Ù„Ø±Ø§Ø¨Ø¹Ø©</p>
                    </div>

                    <div class="info-section">
                        <h3>ğŸ« Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠØ©</h3>
                        <p><strong>ğŸ“ Ø§Ù„ÙƒÙ„ÙŠØ©:</strong> ÙƒÙ„ÙŠØ© Ø§Ù„ØªØ±Ø¨ÙŠØ© Ø§Ù„Ù†ÙˆØ¹ÙŠØ©</p>
                        <p><strong>ğŸ“š Ø§Ù„Ø´Ø¹Ø¨Ø©:</strong> Ù…Ø¹Ù„Ù… Ø­Ø§Ø³Ø¨ Ø¢Ù„ÙŠ</p>
                        <p><strong>ğŸ“– Ø§Ù„Ù…Ø§Ø¯Ø©:</strong> ØªØµÙ…ÙŠÙ… Ù…ÙˆØ§Ù‚Ø¹ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ</p>
                        <p><strong>ğŸ›ï¸ Ø§Ù„Ø¬Ø§Ù…Ø¹Ø©:</strong> Ø¬Ø§Ù…Ø¹Ø© Ù‚Ù†Ø§</p>
                        <p><strong>ğŸ“ Ø§Ù„Ù‚Ø³Ù…:</strong> Ù‚Ø³Ù… ØªÙƒÙ†ÙˆÙ„ÙˆØ¬ÙŠØ§ Ø§Ù„ØªØ¹Ù„ÙŠÙ…</p>
                    </div>

                    <div class="supervisor-card">
                        <h3>ğŸ‘¨â€ğŸ« ØªØ­Øª Ø¥Ø´Ø±Ø§Ù</h3>
                        <p style="font-size: clamp(1.2rem, 4vw, 1.5rem); font-weight: bold;">
                            Ø¯. Ø¹Ù„ÙŠ ÙØ§Ø±ÙˆÙ‚
                        </p>
                    </div>

                    <div class="project-info">
                        <h3>ğŸ“± Ø¹Ù† Ø§Ù„Ù…Ø´Ø±ÙˆØ¹</h3>
                        <p>Ù†Ø¸Ø§Ù… Ø´Ø§Ù…Ù„ Ù„Ø¥Ø¯Ø§Ø±Ø© Ù…Ø³Ø§Ø¨Ù‚Ø§Øª Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ù…Ø¹ Ù†Ø¸Ø§Ù… ØªØµÙˆÙŠØª Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</p>
                        <p>âœ¨ ÙŠØ¯Ø¹Ù… Ø«Ù„Ø§Ø«Ø© Ø£Ù†ÙˆØ§Ø¹ Ù…Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†: Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ØŒ Ø§Ù„Ø¨Ø§Ø¦Ø¹ØŒ ÙˆØ§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø¹Ø§Ø¯ÙŠ</p>
                        <p>ğŸ† Ù†Ø¸Ø§Ù… ØªØµÙˆÙŠØª Ø¹Ø§Ø¯Ù„ Ù…Ø¹ Ø¥Ù…ÙƒØ§Ù†ÙŠØ© Ø¹Ø±Ø¶ Ø§Ù„ÙØ§Ø¦Ø²ÙŠÙ†</p>
                        <p>â° Ù†Ø¸Ø§Ù… Ø¹Ø¯ ØªÙ†Ø§Ø²Ù„ÙŠ Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³Ø§Ø¨Ù‚Ø§Øª</p>
                    </div>

                    <div class="info-section">
                        <h3>ğŸ¯ Ø§Ù„Ù…Ù…ÙŠØ²Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</h3>
                        <p>âœ… <strong>Ù„Ù„Ù…Ø³Ø¤ÙˆÙ„:</strong> Ø¥Ø¯Ø§Ø±Ø© ÙƒØ§Ù…Ù„Ø© Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† ÙˆØ§Ù„Ù…Ù†ØªØ¬Ø§Øª ÙˆØ§Ù„Ø£ØµÙˆØ§Øª</p>
                        <p>âœ… <strong>Ù„Ù„Ø¨Ø§Ø¦Ø¹:</strong> Ø¥Ø¶Ø§ÙØ© ÙˆØªØ¹Ø¯ÙŠÙ„ ÙˆØ­Ø°Ù Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ø®Ø§ØµØ© Ø¨Ù‡</p>
                        <p>âœ… <strong>Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…:</strong> Ø§Ù„ØªØµÙˆÙŠØª Ù„Ù„Ù…Ù†ØªØ¬Ø§Øª ÙˆÙ…Ø´Ø§Ù‡Ø¯Ø© Ø§Ù„Ù†ØªØ§Ø¦Ø¬</p>
                        <p>âœ… <strong>Ù†Ø¸Ø§Ù… Ø°ÙƒÙŠ:</strong> ÙƒØ´Ù Ø§Ù„ØªØ¹Ø§Ø¯Ù„ ÙˆØ¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙØ§Ø¦Ø²ÙŠÙ†</p>
                        <p>âœ… <strong>ØªØµÙ…ÙŠÙ… Ù…ØªØ¬Ø§ÙˆØ¨:</strong> ÙŠØ¹Ù…Ù„ Ø¹Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø¬Ù‡Ø²Ø©</p>
                    </div>

                    <div class="info-section">
                        <h3>ğŸ› ï¸ Ø§Ù„ØªÙ‚Ù†ÙŠØ§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©</h3>
                        <p>ğŸ’» <strong>HTML5 & CSS3:</strong> Ø¨Ù†Ø§Ø¡ ÙˆØ§Ø¬Ù‡Ø© Ù…Ø³ØªØ®Ø¯Ù… Ø­Ø¯ÙŠØ«Ø© ÙˆÙ…ØªØ¬Ø§ÙˆØ¨Ø©</p>
                        <p>âš¡ <strong>JavaScript:</strong> Ø¨Ø±Ù…Ø¬Ø© Ø§Ù„ØªÙØ§Ø¹Ù„Ø§Øª ÙˆØ§Ù„ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ©</p>
                        <p>ğŸ—„ï¸ <strong>Supabase:</strong> Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø³Ø­Ø§Ø¨ÙŠØ© ÙˆØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ù„ÙØ§Øª</p>
                        <p>ğŸ¤– <strong>Claude AI:</strong> Ù…Ø³Ø§Ø¹Ø¯ ÙÙŠ Ø§Ù„ØªØ·ÙˆÙŠØ± ÙˆØ§Ù„ØªØµÙ…ÙŠÙ…</p>
                    </div>

                    <div style="text-align: center; margin-top: 30px; padding: 20px; background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); border-radius: 15px;">
                        <p style="font-size: clamp(1rem, 3vw, 1.2rem); color: #667eea; margin: 0;">
                            ğŸ“ Ù…Ø´Ø±ÙˆØ¹ ØªØ®Ø±Ø¬ Ù…Ø§Ø¯Ø© ØªØµÙ…ÙŠÙ… Ù…ÙˆØ§Ù‚Ø¹- Ø§Ù„Ø¹Ø§Ù… Ø§Ù„Ø¬Ø§Ù…Ø¹ÙŠ 2024/2025
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const SUPABASE_URL = 'https://rclvmnkwlmcvlvdmvxak.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJjbHZtbmt3bG1jdmx2ZG12eGFrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQ2NDQxMzQsImV4cCI6MjA4MDIyMDEzNH0.5dxuyOBhyGd9H8Xt30Yxh3bfYjVOZ4YeAkcZOXXDWD0';
        
        const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
        
        let currentUser = null;
        let allProducts = [];
        let allUsers = [];
        let editingProductId = null;
        let countdownInterval = null;
        let winnerAnnouncementTime = null;

        async function register() {
            const email = document.getElementById('authEmail').value.trim();
            const password = document.getElementById('authPassword').value;
            const role = document.getElementById('authRole').value;

            if (!email || !password) {
                alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±');
                return;
            }

            try {
                const { data, error } = await supabase
                    .from('users')
                    .insert([{ email, password, role }])
                    .select();

                if (error) throw error;

                alert('ØªÙ… Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­! ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¢Ù† ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„');
                document.getElementById('authEmail').value = '';
                document.getElementById('authPassword').value = '';
            } catch (error) {
                alert('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ³Ø¬ÙŠÙ„: ' + error.message);
            }
        }

        async function login() {
            const email = document.getElementById('authEmail').value.trim();
            const password = document.getElementById('authPassword').value;

            if (!email || !password) {
                alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±');
                return;
            }

            try {
                const { data, error } = await supabase
                    .from('users')
                    .select('*')
                    .eq('email', email)
                    .eq('password', password)
                    .single();

                if (error) throw error;

                if (!data) {
                    alert('Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ø£Ùˆ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©');
                    return;
                }

                currentUser = data;
                await loadWinnerAnnouncementTime();
                showDashboard(data.role);
            } catch (error) {
                alert('Ø®Ø·Ø£ ÙÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„: ' + error.message);
            }
        }

        function logout() {
            currentUser = null;
            winnerAnnouncementTime = null;
            if (countdownInterval) clearInterval(countdownInterval);
            document.getElementById('authScreen').classList.remove('hidden');
            document.getElementById('adminScreen').classList.add('hidden');
            document.getElementById('sellerScreen').classList.add('hidden');
            document.getElementById('userScreen').classList.add('hidden');
            document.getElementById('infoIcon').classList.add('hidden');
        }

        function openInfoPage() {
            document.getElementById('infoPage').style.display = 'block';
            document.body.style.overflow = 'hidden';
        }

        function closeInfoPage() {
            document.getElementById('infoPage').style.display = 'none';
            document.body.style.overflow = 'auto';
        }

        function showDashboard(role) {
            document.getElementById('authScreen').classList.add('hidden');
            document.getElementById('infoIcon').classList.remove('hidden');
            
            if (role === 'admin') {
                document.getElementById('adminScreen').classList.remove('hidden');
                document.getElementById('adminEmail').textContent = currentUser.email;
                showAdminTab('users');
            } else if (role === 'seller') {
                document.getElementById('sellerScreen').classList.remove('hidden');
                document.getElementById('sellerEmail').textContent = currentUser.email;
                showSellerTab('myproducts');
            } else {
                document.getElementById('userScreen').classList.remove('hidden');
                document.getElementById('userEmail').textContent = currentUser.email;
                showUserTab('products');
            }
        }

        async function showAdminTab(tab) {
            document.getElementById('adminUsers').classList.add('hidden');
            document.getElementById('adminProducts').classList.add('hidden');
            document.getElementById('adminVotes').classList.add('hidden');
            document.getElementById('adminWinner').classList.add('hidden');

            if (tab === 'users') {
                document.getElementById('adminUsers').classList.remove('hidden');
                await loadAllUsers();
            } else if (tab === 'products') {
                document.getElementById('adminProducts').classList.remove('hidden');
                await loadAllProducts('admin');
                await loadSellerFilter();
            } else if (tab === 'votes') {
                document.getElementById('adminVotes').classList.remove('hidden');
                await loadAllVotes();
            } else if (tab === 'winner') {
                document.getElementById('adminWinner').classList.remove('hidden');
                await showWinner('admin');
            }
        }

        async function showSellerTab(tab) {
            document.getElementById('sellerMyProducts').classList.add('hidden');
            document.getElementById('sellerWinner').classList.add('hidden');

            if (tab === 'myproducts') {
                document.getElementById('sellerMyProducts').classList.remove('hidden');
                await loadSellerProducts();
            } else if (tab === 'winner') {
                document.getElementById('sellerWinner').classList.remove('hidden');
                await showWinner('seller');
            }
        }

        async function addNewUser() {
            const email = document.getElementById('newUserEmail').value.trim();
            const password = document.getElementById('newUserPassword').value;
            const role = document.getElementById('newUserRole').value;

            if (!email || !password) {
                alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±');
                return;
            }

            try {
                const { data, error } = await supabase
                    .from('users')
                    .insert([{ email, password, role }])
                    .select();

                if (error) throw error;

                alert('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ù†Ø¬Ø§Ø­!');
                document.getElementById('newUserEmail').value = '';
                document.getElementById('newUserPassword').value = '';
                await loadAllUsers();
            } catch (error) {
                alert('Ø®Ø·Ø£ ÙÙŠ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…: ' + error.message);
            }
        }

        async function loadAllUsers() {
            try {
                const { data, error } = await supabase
                    .from('users')
                    .select('*');

                if (error) throw error;

                allUsers = data;
                displayUsers(data);
            } catch (error) {
                alert('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†: ' + error.message);
            }
        }

        function displayUsers(users) {
            const tbody = document.querySelector('#usersTable tbody');
            tbody.innerHTML = '';

            users.forEach(user => {
                const row = tbody.insertRow();
                row.insertCell(0).textContent = user.email;
                row.insertCell(1).textContent = user.role === 'admin' ? 'Ù…Ø³Ø¤ÙˆÙ„' : user.role === 'seller' ? 'Ø¨Ø§Ø¦Ø¹' : 'Ù…Ø³ØªØ®Ø¯Ù…';
                
                const actionsCell = row.insertCell(2);
                actionsCell.innerHTML = `
                    <button class="btn-delete" onclick="deleteUser('${user.email}')">ğŸ—‘ï¸ Ø­Ø°Ù</button>
                `;
            });
        }

        async function deleteUser(email) {
            if (!confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ØŸ')) {
                return;
            }

            try {
                const { error } = await supabase
                    .from('users')
                    .delete()
                    .eq('email', email);

                if (error) throw error;

                alert('ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ù†Ø¬Ø§Ø­!');
                await loadAllUsers();
            } catch (error) {
                alert('Ø®Ø·Ø£ ÙÙŠ Ø­Ø°Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…: ' + error.message);
            }
        }

        function searchUsers() {
            const searchTerm = document.getElementById('searchUsers').value.toLowerCase();
            const filteredUsers = allUsers.filter(user => 
                user.email.toLowerCase().includes(searchTerm) ||
                user.role.toLowerCase().includes(searchTerm)
            );
            displayUsers(filteredUsers);
        }

        async function loadSellerFilter() {
            const { data: products, error } = await supabase
                .from('products')
                .select('seller_email');

            if (error) return;

            const sellers = [...new Set(products.map(p => p.seller_email))];
            const select = document.getElementById('filterAdminSeller');
            select.innerHTML = '<option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨Ø§Ø¦Ø¹ÙŠÙ†</option>';
            
            sellers.forEach(seller => {
                const option = document.createElement('option');
                option.value = seller;
                option.textContent = seller;
                select.appendChild(option);
            });
        }

        function searchAdminProducts() {
            const searchTerm = document.getElementById('searchAdminProducts').value.toLowerCase();
            const filteredProducts = allProducts.filter(product => 
                product.name.toLowerCase().includes(searchTerm) ||
                product.description.toLowerCase().includes(searchTerm) ||
                product.seller_email.toLowerCase().includes(searchTerm)
            );
            displayProducts(filteredProducts, 'admin');
        }

        function filterAdminProducts() {
            const seller = document.getElementById('filterAdminSeller').value;
            if (seller) {
                const filteredProducts = allProducts.filter(p => p.seller_email === seller);
                displayProducts(filteredProducts, 'admin');
            } else {
                displayProducts(allProducts, 'admin');
            }
        }

        async function loadAllProducts(view) {
            try {
                const { data: products, error } = await supabase
                    .from('products')
                    .select('*');

                if (error) throw error;

                const { data: votes, error: votesError } = await supabase
                    .from('votes')
                    .select('*');

                if (votesError) throw votesError;

                allProducts = products.map(product => ({
                    ...product,
                    voteCount: votes.filter(v => v.product_id === product.id).length
                }));

                displayProducts(allProducts, view);
            } catch (error) {
                alert('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª: ' + error.message);
            }
        }

        function displayProducts(products, view) {
            const gridId = view === 'admin' ? 'adminProductsGrid' : 
                          view === 'seller' ? 'sellerProductsGrid' : 'userProductsGrid';
            const grid = document.getElementById(gridId);
            grid.innerHTML = '';

            products.forEach(product => {
                const card = createProductCard(product, product.voteCount, view);
                grid.appendChild(card);
            });
        }

        async function loadAllVotes() {
            try {
                const { data, error } = await supabase
                    .from('votes')
                    .select('*, products(name)');

                if (error) throw error;

                const tbody = document.querySelector('#votesTable tbody');
                tbody.innerHTML = '';

                data.forEach(vote => {
                    const row = tbody.insertRow();
                    row.insertCell(0).textContent = vote.user_email;
                    row.insertCell(1).textContent = vote.products?.name || 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ';
                    row.insertCell(2).textContent = new Date(vote.created_at).toLocaleString('ar-EG');
                });
            } catch (error) {
                alert('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£ØµÙˆØ§Øª: ' + error.message);
            }
        }

        async function uploadProduct() {
            const name = document.getElementById('productName').value.trim();
            const description = document.getElementById('productDescription').value.trim();
            const fileInput = document.getElementById('productImage');
            const file = fileInput.files[0];

            if (!name || !description || !file) {
                alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ ÙˆØ§Ø®ØªÙŠØ§Ø± ØµÙˆØ±Ø©');
                return;
            }

            try {
                const fileExt = file.name.split('.').pop();
                const fileName = `${Date.now()}_${Math.random().toString(36).substring(7)}.${fileExt}`;

                const { data: uploadData, error: uploadError } = await supabase.storage
                    .from('seller_uploads')
                    .upload(fileName, file);

                if (uploadError) throw uploadError;

                const { data: urlData } = supabase.storage
                    .from('seller_uploads')
                    .getPublicUrl(fileName);

                const { data, error } = await supabase
                    .from('products')
                    .insert([{
                        seller_email: currentUser.email,
                        name,
                        description,
                        file_url: urlData.publicUrl
                    }])
                    .select();

                if (error) throw error;

                alert('ØªÙ… Ø±ÙØ¹ Ø§Ù„Ù…Ù†ØªØ¬ Ø¨Ù†Ø¬Ø§Ø­!');
                document.getElementById('productName').value = '';
                document.getElementById('productDescription').value = '';
                document.getElementById('productImage').value = '';
                await loadSellerProducts();
            } catch (error) {
                alert('Ø®Ø·Ø£ ÙÙŠ Ø±ÙØ¹ Ø§Ù„Ù…Ù†ØªØ¬: ' + error.message);
            }
        }

        async function loadSellerProducts() {
            try {
                const { data: products, error } = await supabase
                    .from('products')
                    .select('*')
                    .eq('seller_email', currentUser.email);

                if (error) throw error;

                const { data: votes, error: votesError } = await supabase
                    .from('votes')
                    .select('*');

                if (votesError) throw votesError;

                allProducts = products.map(product => ({
                    ...product,
                    voteCount: votes.filter(v => v.product_id === product.id).length
                }));

                displayProducts(allProducts, 'seller');
            } catch (error) {
                alert('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª: ' + error.message);
            }
        }

        function searchSellerProducts() {
            const searchTerm = document.getElementById('searchSellerProducts').value.toLowerCase();
            const filteredProducts = allProducts.filter(product => 
                product.name.toLowerCase().includes(searchTerm) ||
                product.description.toLowerCase().includes(searchTerm)
            );
            displayProducts(filteredProducts, 'seller');
        }

        function openEditModal(productId) {
            const product = allProducts.find(p => p.id === productId);
            if (!product) return;

            editingProductId = productId;
            document.getElementById('editProductName').value = product.name;
            document.getElementById('editProductDescription').value = product.description;
            document.getElementById('editProductImage').value = '';
            document.getElementById('editModal').style.display = 'block';
        }

        function closeEditModal() {
            document.getElementById('editModal').style.display = 'none';
            editingProductId = null;
        }

        async function saveProductEdit() {
            const name = document.getElementById('editProductName').value.trim();
            const description = document.getElementById('editProductDescription').value.trim();
            const fileInput = document.getElementById('editProductImage');
            const file = fileInput.files[0];

            if (!name || !description) {
                alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„');
                return;
            }

            try {
                let updateData = { name, description };

                if (file) {
                    const fileExt = file.name.split('.').pop();
                    const fileName = `${Date.now()}_${Math.random().toString(36).substring(7)}.${fileExt}`;

                    const { data: uploadData, error: uploadError } = await supabase.storage
                        .from('seller_uploads')
                        .upload(fileName, file);

                    if (uploadError) throw uploadError;

                    const { data: urlData } = supabase.storage
                        .from('seller_uploads')
                        .getPublicUrl(fileName);

                    updateData.file_url = urlData.publicUrl;
                }

                const { data, error } = await supabase
                    .from('products')
                    .update(updateData)
                    .eq('id', editingProductId)
                    .select();

                if (error) throw error;

                alert('ØªÙ… ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬ Ø¨Ù†Ø¬Ø§Ø­!');
                closeEditModal();
                await loadSellerProducts();
            } catch (error) {
                alert('Ø®Ø·Ø£ ÙÙŠ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬: ' + error.message);
            }
        }

        async function deleteProduct(productId) {
            if (!confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†ØªØ¬ØŸ')) {
                return;
            }

            try {
                const { error } = await supabase
                    .from('products')
                    .delete()
                    .eq('id', productId);

                if (error) throw error;

                alert('ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ù†ØªØ¬ Ø¨Ù†Ø¬Ø§Ø­!');
                
                if (currentUser.role === 'seller') {
                    await loadSellerProducts();
                } else if (currentUser.role === 'admin') {
                    await loadAllProducts('admin');
                }
            } catch (error) {
                alert('Ø®Ø·Ø£ ÙÙŠ Ø­Ø°Ù Ø§Ù„Ù…Ù†ØªØ¬: ' + error.message);
            }
        }

        async function showUserTab(tab) {
            document.getElementById('userProducts').classList.add('hidden');
            document.getElementById('userWinner').classList.add('hidden');

            if (tab === 'products') {
                document.getElementById('userProducts').classList.remove('hidden');
                await loadAllProducts('user');
            } else if (tab === 'winner') {
                document.getElementById('userWinner').classList.remove('hidden');
                await showWinner('user');
            }
        }

        function searchUserProducts() {
            const searchTerm = document.getElementById('searchUserProducts').value.toLowerCase();
            const filteredProducts = allProducts.filter(product => 
                product.name.toLowerCase().includes(searchTerm) ||
                product.description.toLowerCase().includes(searchTerm) ||
                product.seller_email.toLowerCase().includes(searchTerm)
            );
            displayProducts(filteredProducts, 'user');
        }

        function filterUserProducts() {
            const filter = document.getElementById('filterUserProducts').value;
            let sortedProducts = [...allProducts];

            if (filter === 'most_voted') {
                sortedProducts.sort((a, b) => b.voteCount - a.voteCount);
            } else if (filter === 'least_voted') {
                sortedProducts.sort((a, b) => a.voteCount - b.voteCount);
            }

            displayProducts(sortedProducts, 'user');
        }

        async function voteForProduct(productId) {
            try {
                const { data: existingVotes, error: checkError } = await supabase
                    .from('votes')
                    .select('*')
                    .eq('user_email', currentUser.email);

                if (checkError) throw checkError;

                if (existingVotes && existingVotes.length > 0) {
                    const previousVote = existingVotes[0];
                    
                    if (previousVote.product_id === productId) {
                        alert('âš ï¸ Ù„Ù‚Ø¯ ØµÙˆØªØª Ø¹Ù„Ù‰ Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†ØªØ¬ Ø¨Ø§Ù„ÙØ¹Ù„!');
                        return;
                    }
                    
                    const changeVote = confirm('Ù„Ù‚Ø¯ ØµÙˆØªØª Ø¹Ù„Ù‰ Ù…Ù†ØªØ¬ Ø¢Ø®Ø± Ù…Ù† Ù‚Ø¨Ù„. Ù‡Ù„ ØªØ±ÙŠØ¯ ØªØºÙŠÙŠØ± ØµÙˆØªÙƒ Ù„Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†ØªØ¬ØŸ');
                    
                    if (!changeVote) {
                        return;
                    }
                    
                    const { error: deleteError } = await supabase
                        .from('votes')
                        .delete()
                        .eq('user_email', currentUser.email);
                    
                    if (deleteError) throw deleteError;
                }

                const { data, error } = await supabase
                    .from('votes')
                    .insert([{
                        user_email: currentUser.email,
                        product_id: productId,
                        created_at: new Date().toISOString()
                    }]);

                if (error) throw error;

                alert('âœ… ØªÙ… Ø§Ù„ØªØµÙˆÙŠØª Ø¨Ù†Ø¬Ø§Ø­!');
                await loadAllProducts('user');
            } catch (error) {
                alert('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØµÙˆÙŠØª: ' + error.message);
            }
        }

        function createProductCard(product, voteCount, view) {
            const card = document.createElement('div');
            card.className = 'product-card';

            let buttons = '';
            if (view === 'user') {
                buttons = `<button onclick="voteForProduct(${product.id})">â¤ï¸ ØµÙˆÙ‘Øª Ù„Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†ØªØ¬</button>`;
            } else if (view === 'seller') {
                buttons = `
                    <div class="button-group">
                        <button class="btn-edit" onclick="openEditModal(${product.id})">âœï¸ ØªØ¹Ø¯ÙŠÙ„</button>
                        <button class="btn-delete" onclick="deleteProduct(${product.id})">ğŸ—‘ï¸ Ø­Ø°Ù</button>
                    </div>
                `;
            } else if (view === 'admin') {
                buttons = `
                    <button class="btn-delete" onclick="deleteProduct(${product.id})">ğŸ—‘ï¸ Ø­Ø°Ù Ø§Ù„Ù…Ù†ØªØ¬</button>
                `;
            }

            card.innerHTML = `
                <img src="${product.file_url}" alt="${product.name}">
                <h3>${product.name}</h3>
                <p>${product.description}</p>
                <p><strong>Ø§Ù„Ø¨Ø§Ø¦Ø¹:</strong> ${product.seller_email}</p>
                <div class="votes-count">â¤ï¸ ${voteCount} ØµÙˆØª</div>
                ${buttons}
            `;

            return card;
        }

        async function loadWinnerAnnouncementTime() {
            try {
                const { data, error } = await supabase
                    .from('settings')
                    .select('*')
                    .eq('key', 'winner_announcement_time')
                    .single();

                if (error && error.code !== 'PGRST116') throw error;

                if (data) {
                    winnerAnnouncementTime = new Date(data.value);
                }
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ ÙˆÙ‚Øª Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†:', error);
            }
        }

        async function setWinnerAnnouncementTime() {
            const now = new Date();
            const announcementTime = new Date(now.getTime() + 24 * 60 * 60 * 1000);

            try {
                const { data: existing, error: checkError } = await supabase
                    .from('settings')
                    .select('*')
                    .eq('key', 'winner_announcement_time')
                    .single();

                if (checkError && checkError.code !== 'PGRST116') throw checkError;

                if (existing) {
                    const { error } = await supabase
                        .from('settings')
                        .update({ value: announcementTime.toISOString() })
                        .eq('key', 'winner_announcement_time');

                    if (error) throw error;
                } else {
                    const { error } = await supabase
                        .from('settings')
                        .insert([{
                            key: 'winner_announcement_time',
                            value: announcementTime.toISOString()
                        }]);

                    if (error) throw error;
                }

                winnerAnnouncementTime = announcementTime;
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ¹ÙŠÙŠÙ† ÙˆÙ‚Øª Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†:', error);
            }
        }

        async function resetCompetition() {
            if (!confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† ØªØµÙÙŠØ± Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ØŸ Ø³ÙŠØªÙ… Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£ØµÙˆØ§Øª ÙˆØ¨Ø¯Ø¡ Ù…Ø³Ø§Ø¨Ù‚Ø© Ø¬Ø¯ÙŠØ¯Ø©.')) {
                return;
            }

            try {
                const { error } = await supabase
                    .from('votes')
                    .delete()
                    .neq('id', 0);

                if (error) throw error;

                const { error: settingsError } = await supabase
                    .from('settings')
                    .delete()
                    .eq('key', 'winner_announcement_time');

                if (settingsError) throw settingsError;

                winnerAnnouncementTime = null;
                if (countdownInterval) clearInterval(countdownInterval);

                alert('âœ… ØªÙ… ØªØµÙÙŠØ± Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø¨Ù†Ø¬Ø§Ø­!');
                await showWinner('admin');
            } catch (error) {
                alert('Ø®Ø·Ø£ ÙÙŠ ØªØµÙÙŠØ± Ø§Ù„Ù†ØªØ§Ø¦Ø¬: ' + error.message);
            }
        }

        function updateCountdown(container) {
            if (!winnerAnnouncementTime) return;

            const now = new Date();
            const timeLeft = winnerAnnouncementTime - now;

            if (timeLeft <= 0) {
                if (countdownInterval) clearInterval(countdownInterval);
                const countdownEl = container.querySelector('.countdown');
                if (countdownEl) {
                    countdownEl.innerHTML = 'â° Ø§Ù†ØªÙ‡Ù‰ ÙˆÙ‚Øª Ø§Ù„ØªØµÙÙŠØ± - ÙŠÙ…ÙƒÙ† Ø§Ù„Ø¢Ù† ØªØµÙÙŠØ± Ø§Ù„Ù†ØªØ§Ø¦Ø¬';
                }
                return;
            }

            const hours = Math.floor(timeLeft / (1000 * 60 * 60));
            const minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((timeLeft % (1000 * 60)) / 1000);

            const countdownEl = container.querySelector('.countdown');
            if (countdownEl) {
                countdownEl.innerHTML = `â° Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ: ${hours} Ø³Ø§Ø¹Ø© ${minutes} Ø¯Ù‚ÙŠÙ‚Ø© ${seconds} Ø«Ø§Ù†ÙŠØ©`;
            }
        }

        async function showWinner(view) {
            try {
                const { data: votes, error: votesError } = await supabase
                    .from('votes')
                    .select('product_id');

                if (votesError) throw votesError;

                let container;
                if (view === 'admin') {
                    container = document.getElementById('adminWinner');
                } else if (view === 'seller') {
                    container = document.getElementById('sellerWinner');
                } else {
                    container = document.getElementById('userWinner');
                }

                if (!votes || votes.length === 0) {
                    container.innerHTML = '<p style="text-align:center;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£ØµÙˆØ§Øª Ø¨Ø¹Ø¯</p>';
                    return;
                }

                const voteCounts = {};
                votes.forEach(vote => {
                    voteCounts[vote.product_id] = (voteCounts[vote.product_id] || 0) + 1;
                });

                // Ø¥ÙŠØ¬Ø§Ø¯ Ø£Ø¹Ù„Ù‰ Ø¹Ø¯Ø¯ Ø£ØµÙˆØ§Øª
                const maxVotes = Math.max(...Object.values(voteCounts));
                
                // Ø¥ÙŠØ¬Ø§Ø¯ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„ØªÙŠ Ø­ØµÙ„Øª Ø¹Ù„Ù‰ Ø£Ø¹Ù„Ù‰ Ø¹Ø¯Ø¯ Ø£ØµÙˆØ§Øª (ÙÙŠ Ø­Ø§Ù„Ø© Ø§Ù„ØªØ¹Ø§Ø¯Ù„)
                const winnerIds = Object.keys(voteCounts).filter(id => voteCounts[id] === maxVotes);

                if (winnerIds.length === 0) {
                    container.innerHTML = '<p style="text-align:center;">Ù„Ø§ ÙŠÙˆØ¬Ø¯ ÙØ§Ø¦Ø² Ø¨Ø¹Ø¯</p>';
                    return;
                }

                // Ø¬Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„ÙØ§Ø¦Ø²Ø©
                const { data: winners, error } = await supabase
                    .from('products')
                    .select('*')
                    .in('id', winnerIds);

                if (error) throw error;

                let resetSection = '';
                
                // Ù„Ù„Ù…Ø³Ø¤ÙˆÙ„ ÙÙ‚Ø·: Ø¥Ø¸Ù‡Ø§Ø± Ø²Ø± Ø§Ù„ØªÙØ¹ÙŠÙ„ Ø£Ùˆ Ø²Ø± Ø§Ù„ØªØµÙÙŠØ±
                if (view === 'admin') {
                    if (!winnerAnnouncementTime) {
                        resetSection = `
                            <div class="reset-info">
                                <p>âš ï¸ Ù„Ù… ÙŠØªÙ… ØªÙØ¹ÙŠÙ„ Ù…Ø¤Ù‚Øª Ø§Ù„ØªØµÙÙŠØ± Ø¨Ø¹Ø¯</p>
                                <button class="btn-success" onclick="setWinnerAnnouncementTime(); showWinner('admin');">
                                    ğŸ• ØªÙØ¹ÙŠÙ„ Ù…Ø¤Ù‚Øª 24 Ø³Ø§Ø¹Ø©
                                </button>
                            </div>
                        `;
                    } else {
                        const now = new Date();
                        const timeLeft = winnerAnnouncementTime - now;

                        if (timeLeft > 0) {
                            resetSection = `
                                <div class="reset-info">
                                    <p>Ø³ÙŠØªÙ… Ø¥ØªØ§Ø­Ø© Ø²Ø± ØªØµÙÙŠØ± Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø¨Ø¹Ø¯:</p>
                                    <div class="countdown"></div>
                                    <p style="margin-top:10px; font-size:0.9em;">âš ï¸ Ù„Ø§ ÙŠÙ…ÙƒÙ† ØªØµÙÙŠØ± Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ù‚Ø¨Ù„ Ø§Ù†ØªÙ‡Ø§Ø¡ 24 Ø³Ø§Ø¹Ø©</p>
                                </div>
                            `;
                        } else {
                            resetSection = `
                                <div class="reset-info" style="background: #d4edda; border-color: #28a745;">
                                    <p style="color: #155724;">âœ… ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¢Ù† ØªØµÙÙŠØ± Ø§Ù„Ù†ØªØ§Ø¦Ø¬ ÙˆØ¨Ø¯Ø¡ Ù…Ø³Ø§Ø¨Ù‚Ø© Ø¬Ø¯ÙŠØ¯Ø©</p>
                                    <button class="btn-danger" onclick="resetCompetition()" style="margin-top:10px;">
                                        ğŸ”„ ØªØµÙÙŠØ± Ø§Ù„Ù†ØªØ§Ø¦Ø¬ ÙˆØ¨Ø¯Ø¡ Ù…Ø³Ø§Ø¨Ù‚Ø© Ø¬Ø¯ÙŠØ¯Ø©
                                    </button>
                                </div>
                            `;
                        }
                    }
                } 
                // Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† ÙˆØ§Ù„Ø¨Ø§Ø¦Ø¹ÙŠÙ†: Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø¹Ø¯ Ø§Ù„ØªÙ†Ø§Ø²Ù„ÙŠ ÙÙ‚Ø· Ø¨Ø¯ÙˆÙ† Ø£Ø²Ø±Ø§Ø±
                else {
                    if (winnerAnnouncementTime) {
                        const now = new Date();
                        const timeLeft = winnerAnnouncementTime - now;

                        if (timeLeft > 0) {
                            resetSection = `
                                <div class="reset-info">
                                    <p>Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ Ù„Ø¨Ø¯Ø§ÙŠØ© Ù…Ø³Ø§Ø¨Ù‚Ø© Ø¬Ø¯ÙŠØ¯Ø©:</p>
                                    <div class="countdown"></div>
                                </div>
                            `;
                        } else {
                            resetSection = `
                                <div class="reset-info" style="background: #d4edda; border-color: #28a745;">
                                    <p style="color: #155724;">â° Ø§Ù†ØªÙ‡Ù‰ ÙˆÙ‚Øª Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø³Ø§Ø¨Ù‚Ø© - Ø³ÙŠØ¨Ø¯Ø£ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ Ù…Ø³Ø§Ø¨Ù‚Ø© Ø¬Ø¯ÙŠØ¯Ø© Ù‚Ø±ÙŠØ¨Ø§Ù‹</p>
                                </div>
                            `;
                        }
                    }
                }
                
                // Ø¨Ù†Ø§Ø¡ HTML Ù„Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„ÙØ§Ø¦Ø²Ø©
                let winnersHTML = '';
                
                if (winnerIds.length > 1) {
                    // ÙÙŠ Ø­Ø§Ù„Ø© Ø§Ù„ØªØ¹Ø§Ø¯Ù„
                    winnersHTML = `
                        <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 15px; border-radius: 10px; margin-bottom: 20px; text-align: center;">
                            <h2 style="margin: 0; color: white;">ğŸŠ ØªØ¹Ø§Ø¯Ù„! ÙŠÙˆØ¬Ø¯ ${winnerIds.length} ÙØ§Ø¦Ø²ÙŠÙ† ğŸŠ</h2>
                            <p style="margin: 10px 0 0 0; font-size: 1.2em;">ÙƒÙ„ Ù…Ù†Ù‡Ù… Ø­ØµÙ„ Ø¹Ù„Ù‰ ${maxVotes} ØµÙˆØª</p>
                        </div>
                        <div class="products-grid">
                    `;
                    
                    winners.forEach(winner => {
                        winnersHTML += `
                            <div class="winner-card">
                                <h3>ğŸ† Ù…Ù†ØªØ¬ ÙØ§Ø¦Ø² ğŸ†</h3>
                                <img src="${winner.file_url}" alt="${winner.name}">
                                <h2>${winner.name}</h2>
                                <p>${winner.description}</p>
                                <p><strong>Ø§Ù„Ø¨Ø§Ø¦Ø¹:</strong> ${winner.seller_email}</p>
                                <div style="font-size:1.5em;margin-top:20px;">
                                    â¤ï¸ ${maxVotes} ØµÙˆØª
                                </div>
                            </div>
                        `;
                    });
                    
                    winnersHTML += '</div>';
                } else {
                    // ÙØ§Ø¦Ø² ÙˆØ§Ø­Ø¯ ÙÙ‚Ø·
                    const winner = winners[0];
                    winnersHTML = `
                        <div class="winner-card">
                            <h3>ğŸ† Ø§Ù„Ù…Ù†ØªØ¬ Ø§Ù„ÙØ§Ø¦Ø² ğŸ†</h3>
                            <img src="${winner.file_url}" alt="${winner.name}">
                            <h2>${winner.name}</h2>
                            <p>${winner.description}</p>
                            <p><strong>Ø§Ù„Ø¨Ø§Ø¦Ø¹:</strong> ${winner.seller_email}</p>
                            <div style="font-size:1.5em;margin-top:20px;">
                                â¤ï¸ ${maxVotes} ØµÙˆØª
                            </div>
                        </div>
                    `;
                }
                
                container.innerHTML = winnersHTML + resetSection;

                // ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¹Ø¯ Ø§Ù„ØªÙ†Ø§Ø²Ù„ÙŠ Ù„Ù„Ø¬Ù…ÙŠØ¹ (Ù…Ø³Ø¤ÙˆÙ„ØŒ Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†ØŒ Ø¨Ø§Ø¦Ø¹ÙŠÙ†)
                if (winnerAnnouncementTime) {
                    const now = new Date();
                    if (winnerAnnouncementTime > now) {
                        updateCountdown(container);
                        if (countdownInterval) clearInterval(countdownInterval);
                        countdownInterval = setInterval(() => updateCountdown(container), 1000);
                    }
                }
            } catch (error) {
                alert('Ø®Ø·Ø£ ÙÙŠ Ø¹Ø±Ø¶ Ø§Ù„ÙØ§Ø¦Ø²: ' + error.message);
            }
        }
    </script>
</body>
</html>